SPARK_MAJOR_VERSION=2 spark-submit \
--master yarn \
--queue datalab \
--driver-memory 20g \
--num-executors 139 \
--executor-memory 30g \
--executor-cores 5 \
--conf spark.memory.fraction=0.7 \
--conf spark.memory.storageFraction=0.3 \
--conf spark.memory.offHeap.enabled=true \
--conf spark.memory.offHeap.size=40g \
--conf spark.local.dir=hdfs:///tmp/spark-temp \
--conf spark.shuffle.service.enabled=true \
--conf spark.yarn.executor.memoryOverhead=4096 \
--conf spark.storage.level=MEMORY_AND_DISK_SER \
--conf spark.shuffle.file.buffer=1m \
--conf spark.reducer.maxReqsInFlight=1 \
--conf spark.reducer.maxSizeInFlight=96m \
--class org.apache.spark.examples.SparkPi \
/tmp/AER.DHF-2173/sctipt_count.py