@SuppressWarnings("unchecked")
private static Object deepMerge(Object oldVal, Object newVal) {
    if (oldVal instanceof Document && newVal instanceof Document) {
        Document merged = new Document((Document) oldVal);
        for (Map.Entry<String, Object> e : ((Document) newVal).entrySet()) {
            merged.put(e.getKey(), deepMerge(merged.get(e.getKey()), e.getValue()));
        }
        return merged;
    }
    // Otherwise, new value overrides old
    return newVal != null ? newVal : oldVal;
}

public static Document deepMergePayloads(List<Document> documents) {
    Document merged = new Document();

    for (Document doc : documents) {
        Document payload = doc.get("payload", Document.class);
        if (payload == null) continue;

        for (Map.Entry<String, Object> entry : payload.entrySet()) {
            merged.put(entry.getKey(), 
                       deepMerge(merged.get(entry.getKey()), entry.getValue()));
        }
    }

    return merged;
}