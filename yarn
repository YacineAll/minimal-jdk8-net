# Base image with Java 8
FROM openjdk:8-jdk

# Install Hadoop (use internal Hadoop distribution)
COPY hadoop-3.x.tar.gz /opt/
WORKDIR /opt/
RUN tar -xzf hadoop-3.x.tar.gz && mv hadoop-3.x hadoop

# Set environment variables for Hadoop
ENV HADOOP_HOME=/opt/hadoop
ENV PATH=$PATH:$HADOOP_HOME/bin:$HADOOP_HOME/sbin

# Install Spark (use internal Spark distribution)
COPY spark-2.4.8-bin-hadoop2.7.tgz /opt/
RUN tar -xzf spark-2.4.8-bin-hadoop2.7.tgz && mv spark-2.4.8-bin-hadoop2.7 spark

# Set environment variables for Spark
ENV SPARK_HOME=/opt/spark
ENV PATH=$PATH:$SPARK_HOME/bin:$SPARK_HOME/sbin

# Expose necessary ports for Hadoop and Spark
EXPOSE 8088 50070 8080 7077 4040

# Default command to keep the container running
CMD ["tail", "-f", "/dev/null"]







version: '3'
services:
  namenode:
    build: ./namenode
    container_name: hadoop_namenode
    ports:
      - "50070:50070"
    environment:
      - HDFS_NAMENODE_USER=root
    volumes:
      - namenode_data:/opt/hadoop/dfs/name
    networks:
      - hadoop_network

  datanode:
    build: ./datanode
    container_name: hadoop_datanode
    environment:
      - HDFS_DATANODE_USER=root
    depends_on:
      - namenode
    networks:
      - hadoop_network

  resourcemanager:
    build: ./resourcemanager
    container_name: hadoop_resourcemanager
    ports:
      - "8088:8088"
    networks:
      - hadoop_network

  nodemanager:
    build: ./nodemanager
    container_name: hadoop_nodemanager
    depends_on:
      - resourcemanager
    networks:
      - hadoop_network

  spark_master:
    build: ./spark_master
    container_name: spark_master
    ports:
      - "7077:7077"
      - "8080:8080"
    depends_on:
      - namenode
    networks:
      - hadoop_network

  spark_worker:
    build: ./spark_worker
    container_name: spark_worker
    depends_on:
      - spark_master
    networks:
      - hadoop_network

volumes:
  namenode_data:

networks:
  hadoop_network:
    driver: bridge






<configuration>
  <property>
    <name>fs.defaultFS</name>
    <value>hdfs://namenode:9000</value>
  </property>
</configuration>


